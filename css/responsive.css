/* Modern Responsive Design for Expedition 33 Planner */

/* Mobile First Approach with Enhanced Breakpoints */

/* Base styles for all devices */
.grid-cols-2 {
  grid-template-columns: 1fr;
}

.grid-cols-3 {
  grid-template-columns: 1fr;
}

.grid-cols-4 {
  grid-template-columns: repeat(2, 1fr);
}

/* Container queries for modern responsive design */
@container (min-width: 20rem) {
  .grid-cols-2 {
    grid-template-columns: repeat(2, 1fr);
  }
}

@container (min-width: 30rem) {
  .grid-cols-3 {
    grid-template-columns: repeat(2, 1fr);
  }
}

@container (min-width: 40rem) {
  .grid-cols-3 {
    grid-template-columns: repeat(3, 1fr);
  }

  .grid-cols-4 {
    grid-template-columns: repeat(3, 1fr);
  }
}

@container (min-width: 60rem) {
  .grid-cols-4 {
    grid-template-columns: repeat(4, 1fr);
  }
}

/* Small mobile (320px and up) */
@media (max-width: 480px) {
  :root {
    --spacing-xs: 0.125rem;
    --spacing-sm: 0.25rem;
    --spacing-md: 0.5rem;
    --spacing-lg: 0.75rem;
    --spacing-xl: 1rem;
    --spacing-2xl: 1.5rem;
  }

  html {
    font-size: 14px;
  }

  .header-content {
    padding: 0 var(--spacing-sm);
  }

  .app-title {
    font-size: 1.4rem;
  }

  .header-controls {
    gap: var(--spacing-xs);
  }

  .nav-tabs {
    padding: 0 var(--spacing-sm);
    gap: 0;
  }

  .nav-tab {
    padding: var(--spacing-sm) var(--spacing-md);
    font-size: 0.8rem;
    min-width: 0;
    flex-shrink: 0;
    border-radius: var(--radius-sm);
  }

  .nav-tab:hover {
    transform: none;
  }

  .card {
    padding: var(--spacing-md);
    border-radius: var(--radius-md);
  }

  .card:hover {
    transform: translateY(-2px);
  }

  .main-content {
    padding: var(--spacing-md);
  }

  .content-header {
    flex-direction: column;
    align-items: stretch;
    gap: var(--spacing-md);
  }

  .content-controls {
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .content-controls > * {
    width: 100%;
  }

  .character-builder {
    grid-template-columns: 1fr;
    gap: var(--spacing-lg);
  }

  .party-composer {
    grid-template-columns: 1fr;
    gap: var(--spacing-lg);
  }

  .party-grid {
    grid-template-columns: 1fr 1fr 1fr;
    gap: var(--spacing-sm);
  }

  .pictos-grid {
    grid-template-columns: 1fr;
    gap: var(--spacing-md);
  }

  .builds-grid {
    grid-template-columns: 1fr;
    gap: var(--spacing-md);
  }

  .collectibles-categories {
    flex-direction: column;
    gap: 0;
  }

  .category-tab {
    border-bottom: none;
    border-left: 3px solid transparent;
    text-align: left;
    padding: var(--spacing-sm) var(--spacing-md);
  }

  .category-tab.active {
    border-left-color: var(--accent-gold);
    border-bottom-color: transparent;
  }

  .modal {
    min-width: unset;
    width: 95vw;
    max-width: 95vw;
  }

  .modal-footer {
    flex-direction: column-reverse;
    gap: var(--spacing-sm);
  }

  .modal-footer button {
    width: 100%;
  }

  .toast-container {
    left: var(--spacing-sm);
    right: var(--spacing-sm);
    top: var(--spacing-sm);
  }

  .toast {
    max-width: none;
  }

  /* Touch-friendly sizing */
  button,
  input,
  select {
    min-height: 44px;
    font-size: 16px; /* Prevents zoom on iOS */
  }

  .btn-icon {
    min-width: 44px;
    min-height: 44px;
  }

  .party-slot {
    min-height: 80px;
  }
}

/* Large mobile (481px to 768px) */
@media (min-width: 481px) and (max-width: 768px) {
  .app-title {
    font-size: 1.6rem;
  }

  .character-builder {
    grid-template-columns: 1fr;
  }

  .party-composer {
    grid-template-columns: 1fr;
  }

  .pictos-grid {
    grid-template-columns: repeat(2, 1fr);
  }

  .builds-grid {
    grid-template-columns: repeat(2, 1fr);
  }

  .content-controls {
    flex-direction: row;
    flex-wrap: wrap;
  }

  .collectibles-categories {
    flex-direction: row;
  }

  .category-tab {
    border-left: none;
    border-bottom: 3px solid transparent;
  }

  .category-tab.active {
    border-bottom-color: var(--accent-gold);
    border-left-color: transparent;
  }
}

/* Tablet (769px to 1024px) */
@media (min-width: 769px) and (max-width: 1024px) {
  .character-builder {
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-xl);
  }

  .party-composer {
    grid-template-columns: 1.5fr 1fr;
  }

  .pictos-grid {
    grid-template-columns: repeat(3, 1fr);
  }

  .builds-grid {
    grid-template-columns: repeat(2, 1fr);
  }

  .nav-tabs {
    justify-content: center;
  }

  .main-content {
    padding: var(--spacing-xl) var(--spacing-lg);
  }
}

/* Desktop (1025px to 1440px) */
@media (min-width: 1025px) and (max-width: 1440px) {
  .character-builder {
    grid-template-columns: 1fr 1fr;
  }

  .party-composer {
    grid-template-columns: 2fr 1fr;
  }

  .pictos-grid {
    grid-template-columns: repeat(4, 1fr);
  }

  .builds-grid {
    grid-template-columns: repeat(3, 1fr);
  }
}

/* Large desktop (1441px and up) */
@media (min-width: 1441px) {
  .character-builder {
    grid-template-columns: 1fr 1fr 1fr;
  }

  .party-composer {
    grid-template-columns: 2fr 1fr;
  }

  .pictos-grid {
    grid-template-columns: repeat(5, 1fr);
  }

  .builds-grid {
    grid-template-columns: repeat(4, 1fr);
  }

  .main-content {
    padding: var(--spacing-2xl);
  }
}

/* Landscape orientation adjustments */
@media (orientation: landscape) and (max-height: 600px) {
  .app-header {
    padding: var(--spacing-sm) var(--spacing-lg);
  }

  .app-title {
    font-size: 1.4rem;
  }

  .nav-tab {
    padding: var(--spacing-sm) var(--spacing-md);
  }

  .main-content {
    padding: var(--spacing-lg);
  }

  .content-header {
    margin-bottom: var(--spacing-lg);
  }

  .party-grid {
    grid-template-columns: repeat(6, 1fr);
  }

  .active-party,
  .reserve-party {
    display: inline-block;
    width: 48%;
    margin-right: 2%;
  }
}

/* High DPI displays */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  /* Ensure images and icons are crisp on retina displays */
  .loading-spinner {
    border-width: 2px;
  }

  .nav-tab.active {
    border-bottom-width: 2px;
  }

  .category-tab.active {
    border-bottom-width: 2px;
  }

  button,
  input,
  select {
    border-width: 1px;
  }
}

/* Reduced motion preferences */
@media (prefers-reduced-motion: reduce) {
  .loading-spinner {
    animation: none;
  }

  .tab-content.active {
    animation: none;
  }

  .toast {
    animation: none;
  }

  * {
    transition-duration: 0.01ms !important;
  }
}

/* Dark mode preference */
@media (prefers-color-scheme: dark) {
  body:not(.theme-light):not(.theme-sepia):not(.theme-high-contrast) {
    /* Already using dark theme as default */
  }
}

/* Light mode preference */
@media (prefers-color-scheme: light) {
  body:not(.theme-dark):not(.theme-sepia):not(.theme-high-contrast) {
    --primary-purple: #2D1B69;
    --secondary-purple: #4A3491;
    --accent-gold: #B8860B;
    --light-gold: #DAA520;
    --dark-background: #FFFFFF;
    --darker-background: #F8FAFC;
    --surface-dark: #F1F5F9;
    --surface-light: #E2E8F0;
    --text-primary: #1E293B;
    --text-secondary: #475569;
    --text-muted: #64748B;
    --border-color: #CBD5E1;
    --hover-color: #E2E8F0;
    --success-color: #059669;
    --warning-color: #D97706;
    --error-color: #DC2626;
  }
}

/* High contrast preference */
@media (prefers-contrast: high) {
  body {
    --border-color: currentColor;
  }

  button,
  input,
  select {
    border-width: 2px;
  }

  .nav-tab.active {
    border-bottom-width: 4px;
  }
}

/* Hover support detection */
@media (hover: hover) {
  .party-slot:hover,
  .nav-tab:hover,
  .btn-primary:hover,
  .btn-secondary:hover,
  .btn-icon:hover {
    /* Hover styles are already defined in main.css */
  }
}

@media (hover: none) {
  /* Remove hover effects on touch devices */
  .party-slot:hover,
  .nav-tab:hover,
  .btn-primary:hover,
  .btn-secondary:hover,
  .btn-icon:hover {
    background: initial;
    color: initial;
    border-color: initial;
    transform: none;
    box-shadow: initial;
  }

  /* Add touch feedback instead */
  .party-slot:active,
  .nav-tab:active,
  .btn-primary:active,
  .btn-secondary:active,
  .btn-icon:active {
    transform: scale(0.98);
    transition: transform 0.1s ease-out;
  }
}

/* Pointer type detection */
@media (pointer: coarse) {
  /* Touch-specific optimizations */
  button,
  .party-slot,
  .nav-tab {
    min-height: 44px;
    min-width: 44px;
  }

  .btn-icon {
    padding: var(--spacing-md);
  }

  .nav-tab {
    padding: var(--spacing-md) var(--spacing-lg);
  }
}

/* Container queries (future-proofing) */
@container (max-width: 600px) {
  .character-builder {
    grid-template-columns: 1fr;
  }
}

/* Print layout adjustments */
@media print {
  @page {
    margin: 1in;
    size: letter;
  }

  .app-container {
    display: block;
  }

  .tab-content {
    display: block !important;
    page-break-before: always;
  }

  .tab-content:first-child {
    page-break-before: auto;
  }

  .character-builder,
  .party-composer {
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
  }

  .pictos-grid,
  .builds-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: 0.5rem;
  }

  h2 {
    border-bottom: 1px solid black;
    padding-bottom: 0.25rem;
    margin-bottom: 0.5rem;
  }

  .content-header {
    margin-bottom: 1rem;
  }

  /* Avoid breaking elements across pages */
  .party-slot,
  .modal,
  .toast {
    break-inside: avoid;
  }
}

/* Accessibility enhancements for screen readers */
@media (prefers-reduced-data: reduce) {
  /* Minimize data usage */
  .loading-spinner {
    animation: none;
  }

  /* Disable non-essential animations */
  .tab-content.active {
    animation: none;
  }
}

/* Focus visible for keyboard navigation */
@media (prefers-reduced-motion: no-preference) {
  :focus-visible {
    outline: 2px solid var(--accent-gold);
    outline-offset: 2px;
    transition: outline var(--transition-fast);
  }
}